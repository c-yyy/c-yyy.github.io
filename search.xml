<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2019é¢è¯•å‡†å¤‡</title>
      <link href="/2019/01/02/2019-Interview/"/>
      <url>/2019/01/02/2019-Interview/</url>
      
        <content type="html"><![CDATA[<h1 id="æŠ€æœ¯"><a href="#æŠ€æœ¯" class="headerlink" title="æŠ€æœ¯"></a>æŠ€æœ¯</h1><ul><li><p>JSåŸºç¡€</p><ul><li>å˜é‡ç±»å‹<br>Stringã€Numberã€Booleanã€Objectã€nullã€undefined<br>Symbol(ç‹¬ä¸€æ— äºŒå€¼,Symbol(â€˜aâ€™))</li><li>ä½œç”¨åŸŸ<br>æ‰§è¡Œä¸Šä¸‹æ–‡ã€è‡ªç”±å˜é‡çš„å‘ä¸ŠæŸ¥æ‰¾</li><li>this<br>æŒ‡å‘æœ€åè°ƒç”¨çš„é‚£ä¸ªå¯¹è±¡<br>ç®­å¤´å‡½æ•°<br>callã€applyã€bind(ä¼ å‚ä¸åŒ)</li><li>åŸå‹<br><strong>proto</strong>æŒ‡å‘å…¶æ„é€ å‡½æ•°çš„prototype<br>instanceofåˆ¤æ–­ä¸€ä¸ªå‡½æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªå˜é‡çš„æ„é€ å‡½æ•°</li><li>é—­åŒ…<br>å‡½æ•°çˆ¶çº§ä½œç”¨åŸŸåœ¨å®šä¹‰æ—¶éæ‰§è¡Œæ—¶<br>å°è£…å˜é‡æ”¶æ•›ä¿®æ”¹æƒé™ï¼Œå˜é‡å§‹ç»ˆä¿å­˜åœ¨å†…å­˜ä¸­å¯ä¾›å…¶ä»–å‡½æ•°è®¿é—®<br>åšå‡½æ•°è¿”å›å€¼ã€åšå‡½æ•°å‚æ•°ä¼ é€’</li><li>ç»§æ‰¿<br>åŸå‹é“¾ç»§æ‰¿ï¼Œç±»å®ä¾‹æŒ‡å‘prototype<br>classç±»extends</li></ul></li><li><p>å¼‚æ­¥</p><ul><li>å•çº¿ç¨‹</li><li>event-loop</li><li>jq-deferred -&gt; promise -&gt; async/await</li></ul></li><li><p>æ¡†æ¶</p><ul><li>React<br>å…³æ³¨React16<br>fiberæ¶æ„<br>Redux<br>Nextjs<br>RN</li><li>Vue<br>å…³æ³¨Vue3<br>Vuex<br>Nuxtjs<br>Weex</li><li>Angluar<br>å…³æ³¨Angluar7<br>æ¨¡ç‰ˆ@Input()ã€@Output()<br>ViewChildã€ElementRef<br>rxjs</li></ul></li><li><p>å°ç¨‹åº</p><ul><li>wepy</li><li>taro</li><li>å°æ¸¸æˆå¼•æ“</li></ul></li><li><p>å·¥å…·è‡ªåŠ¨åŒ–</p><ul><li>git</li><li>rollupã€webpack</li></ul></li><li><p>Nodejs</p></li><li><p>é€šè®¯</p><ul><li>HTTP2</li><li>hybrid</li></ul></li><li><p>HTMLã€CSS</p></li></ul><h1 id="æŠ€å·§"><a href="#æŠ€å·§" class="headerlink" title="æŠ€å·§"></a>æŠ€å·§</h1><ul><li>ç®€å†</li><li>è¯æœ¯</li></ul>]]></content>
      
      
      <categories>
          
          <category> doc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> summary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React16-fiber</title>
      <link href="/2018/12/31/React16-fiber/"/>
      <url>/2018/12/31/React16-fiber/</url>
      
        <content type="html"><![CDATA[<h1 id="fiberæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#fiberæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="fiberæ˜¯ä»€ä¹ˆï¼Ÿ"></a>fiberæ˜¯ä»€ä¹ˆï¼Ÿ</h1><ul><li>React16ä¸­å¯¹diffç®—æ³•çš„é‡æ„</li><li>ç”±stackæ¶æ„ï¼ˆé€’å½’è°ƒç”¨é˜»å¡çº¿ç¨‹ï¼‰è½¬ä¸ºfiberæ¶æ„</li></ul><h1 id="ä¸ºä»€ä¹ˆfiberï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆfiberï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆfiberï¼Ÿ"></a>ä¸ºä»€ä¹ˆfiberï¼Ÿ</h1><ul><li>æ¨ªå‘å¯¹æ¯”stackæ¶æ„</li><li>è°ƒåº¦å¾®ä»»åŠ¡ï¼Œåˆ©ç”¨ç©ºé—²æœŸæ‰§è¡Œå›è°ƒ</li><li>ä½¿diffç®—æ³•å¯æ§å¯è¿½è¸ªï¼ˆè¾¾åˆ°éé˜»å¡ç›®çš„ï¼‰</li></ul><h1 id="æ€æ ·å®ç°fiberï¼Ÿ"><a href="#æ€æ ·å®ç°fiberï¼Ÿ" class="headerlink" title="æ€æ ·å®ç°fiberï¼Ÿ"></a>æ€æ ·å®ç°fiberï¼Ÿ</h1><ul><li><p>çº¤ç»´åŒ–ï¼ˆçº¤ç»´é˜Ÿåˆ—ï¼‰<br>æˆ‘ä»¬éœ€è¦å°†å·¥ä½œåˆ†æˆæ›´å°çš„éƒ¨åˆ†ï¼Œå¹¶ä½¿ä¹‹èƒ½åœ¨çŸ­æ—¶é—´å†…è¿è¡Œï¼Œè®©ä¸»çº¿ç¨‹åšæ›´é«˜ä¼˜å…ˆçº§çš„äº‹æƒ…<br>å¦‚æœçº¿ç¨‹ç©ºé—²ï¼Œé‚£ä¹ˆå›åˆ°çº¤ç»´é˜Ÿåˆ—</p></li><li><p>fiberå¯¹è±¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">let fiber = &#123;</span><br><span class="line">  tag: HOST_ROOT||HOST_COMPONENT||CLASS_COMPONENT,</span><br><span class="line">  type: &quot;div&quot;||Foo,</span><br><span class="line">  parent: parentFiber,</span><br><span class="line">  child: childFiber,</span><br><span class="line">  sibling: null,</span><br><span class="line">  alternate: currentFiber,</span><br><span class="line">  stateNode: document.createElement(&quot;div&quot;), // instance</span><br><span class="line">  props: &#123; children: [], className: &quot;foo&quot;&#125;,</span><br><span class="line">  partialState: null,</span><br><span class="line">  effectTag: PLACEMENT,</span><br><span class="line">  effects: []</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>window.requestIdleCallback()</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const ENOUGH_TIME = 1 //æ¯«ç§’ms</span><br><span class="line">let workQueue = [] // çº¤ç»´é˜Ÿåˆ—</span><br><span class="line">let nextUnitOfWork = null</span><br><span class="line"></span><br><span class="line">function schedule(task) &#123;</span><br><span class="line">  workQueue.push(task)</span><br><span class="line">  requestIdleCallback(performWork)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function performWork(deadline) &#123;</span><br><span class="line">  if(!nextUnitOfWork) &#123;</span><br><span class="line">    nextUnitOfWork = workQueue.shift()</span><br><span class="line">  &#125;</span><br><span class="line">  while(nextUnitOfWork &amp;&amp; deadline.timeRemaining()&gt;ENOUGH_TIME) &#123;</span><br><span class="line">    nextUnitOfWork = performUnitOfWork(nextUnitOfWork) // æ‰§è¡Œå½“å‰workå¹¶è¿”å›ä¸‹æ¬¡workçš„æ‰€æœ‰ä¿¡æ¯</span><br><span class="line">  &#125;</span><br><span class="line">  if(nextUnitOfWork || workQueue.length &gt; 0) &#123;</span><br><span class="line">    requestIdleCallback(performWork)</span><br><span class="line">  &#125;</span><br><span class="line">  if(pendingCommit) &#123;</span><br><span class="line">    commitAllWork(pendingCommit);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>çº¤ç»´é˜Ÿåˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">/ Fiber tags</span><br><span class="line">const HOST_COMPONENT = &quot;host&quot;</span><br><span class="line">const CLASS_COMPONENT = &quot;class&quot;</span><br><span class="line">const HOST_ROOT = &quot;root&quot;</span><br><span class="line"></span><br><span class="line">// Global state</span><br><span class="line">const updateQueue = [] // å­˜å‚¨ç­‰å¾…æ›´æ–°</span><br><span class="line">let nextUnitOfWork = null</span><br><span class="line">let pendingCommit = null</span><br><span class="line"></span><br><span class="line">function render(elements, containerDom) &#123;</span><br><span class="line">  updateQueue.push(&#123;</span><br><span class="line">    from: HOST_ROOT,</span><br><span class="line">    dom: containerDom,</span><br><span class="line">    newProps: &#123; children: elements &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  requestIdleCallback(performWork)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function scheduleUpdate(instance, partialState) &#123;</span><br><span class="line">  updateQueue.push(&#123;</span><br><span class="line">    from: CLASS_COMPONENT,</span><br><span class="line">    instance: instance,</span><br><span class="line">    partialState: partialState</span><br><span class="line">  &#125;)</span><br><span class="line">  requestIdleCallback(performWork)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æé—®rootèŠ‚ç‚¹ä½œä¸ºç¬¬ä¸€å¸§å¦‚ä½•è½¬æ¢æˆnextUnitOfWork<br>ç­”æ¡ˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">function resetNextUnitOfWork() &#123;</span><br><span class="line">  const update = updateQueue.shift();</span><br><span class="line">  if (!update) &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // å°†setStateå‚æ•°ä»æ›´æ–°æœ‰æ•ˆå†…å®¹å¤åˆ¶åˆ°ç›¸åº”çš„å…‰çº¤</span><br><span class="line">  if (update.partialState) &#123;</span><br><span class="line">    update.instance.__fiber.partialState = update.partialState</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  const root =</span><br><span class="line">    update.from == HOST_ROOT</span><br><span class="line">      ? update.dom._rootContainerFiber</span><br><span class="line">      : getRoot(update.instance.__fiber)</span><br><span class="line"></span><br><span class="line">  nextUnitOfWork = &#123;</span><br><span class="line">    tag: HOST_ROOT,</span><br><span class="line">    stateNode: update.dom || root.stateNode,</span><br><span class="line">    props: update.newProps || root.props,</span><br><span class="line">    alternate: root</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getRoot(fiber) &#123;</span><br><span class="line">  let node = fiber</span><br><span class="line">  while (node.parent) &#123;</span><br><span class="line">    node = node.parent</span><br><span class="line">  &#125;</span><br><span class="line">  return node</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>æé—®å¦‚ä½•æ„é€ åç»­å¸§å¹¶ç”ŸæˆfiberTreeğŸŒ²ï¼Ÿ<br>ç­”æ¡ˆï¼š<br><code>å…ˆå¤„ç†å¶å­èŠ‚ç‚¹ï¼Œç„¶åæ˜¯å…¶å…„å¼ŸèŠ‚ç‚¹ï¼Œç„¶åæ˜¯åŒäº²èŠ‚ç‚¹ï¼Œä»ä¸‹å¾€ä¸Šéå†</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function performUnitOfWork(wipFiber) &#123;</span><br><span class="line">  beginWork(wipFiber)</span><br><span class="line">  if (wipFiber.child) &#123;</span><br><span class="line">    return wipFiber.child</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // éå†ï¼Œç›´åˆ°æ²¡æœ‰child</span><br><span class="line">  let uow = wipFiber</span><br><span class="line">  while (uow) &#123;</span><br><span class="line">    completeWork(uow)</span><br><span class="line">    if (uow.sibling) &#123;</span><br><span class="line">      // Sibling needs to beginWork</span><br><span class="line">      return uow.sibling</span><br><span class="line">    &#125;</span><br><span class="line">    uow = uow.parent</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote></li><li><p>fiberæµç¨‹å›¾<br><img src="../../public/img/fiber.png" alt="fiberæµç¨‹å›¾"></p></li><li><p>å¤„ç†æ›´æ–°ç»„ä»¶propså’Œstate</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">function beginWork(wipFiber) &#123;</span><br><span class="line">  if (wipFiber.tag == CLASS_COMPONENT) &#123;</span><br><span class="line">    updateClassComponent(wipFiber);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    updateHostComponent(wipFiber);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function updateHostComponent(wipFiber) &#123;</span><br><span class="line">  if (!wipFiber.stateNode) &#123;</span><br><span class="line">    wipFiber.stateNode = createDomElement(wipFiber);</span><br><span class="line">  &#125;</span><br><span class="line">  const newChildElements = wipFiber.props.children;</span><br><span class="line">  reconcileChildrenArray(wipFiber, newChildElements);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function updateClassComponent(wipFiber) &#123;</span><br><span class="line">  let instance = wipFiber.stateNode;</span><br><span class="line">  if (instance == null) &#123;</span><br><span class="line">    // Call class constructor</span><br><span class="line">    instance = wipFiber.stateNode = createInstance(wipFiber);</span><br><span class="line">  &#125; else if (wipFiber.props == instance.props &amp;&amp; !wipFiber.partialState) &#123;</span><br><span class="line">    // No need to render, clone children from last time</span><br><span class="line">    cloneChildFibers(wipFiber);</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  instance.props = wipFiber.props;</span><br><span class="line">  instance.state = Object.assign(&#123;&#125;, instance.state, wipFiber.partialState);</span><br><span class="line">  wipFiber.partialState = null;</span><br><span class="line"></span><br><span class="line">  const newChildElements = wipFiber.stateNode.render();</span><br><span class="line">  reconcileChildrenArray(wipFiber, newChildElements);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å¼€å§‹diffï¼Œå°†oldFiberä¸elementsåšå¯¹æ¯”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">// Effect tags</span><br><span class="line">const PLACEMENT = 1;</span><br><span class="line">const DELETION = 2;</span><br><span class="line">const UPDATE = 3;</span><br><span class="line"></span><br><span class="line">function arrify(val) &#123;</span><br><span class="line">  return val == null ? [] : Array.isArray(val) ? val : [val];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function reconcileChildrenArray(wipFiber, newChildElements) &#123;</span><br><span class="line">  const elements = arrify(newChildElements);</span><br><span class="line"></span><br><span class="line">  let index = 0;</span><br><span class="line">  let oldFiber = wipFiber.alternate ? wipFiber.alternate.child : null;</span><br><span class="line">  let newFiber = null;</span><br><span class="line">  while (index &lt; elements.length || oldFiber != null) &#123;</span><br><span class="line">    const prevFiber = newFiber;</span><br><span class="line">    const element = index &lt; elements.length &amp;&amp; elements[index];</span><br><span class="line">    const sameType = oldFiber &amp;&amp; element &amp;&amp; element.type == oldFiber.type;</span><br><span class="line"></span><br><span class="line">    if (sameType) &#123;</span><br><span class="line">      newFiber = &#123;</span><br><span class="line">        type: oldFiber.type,</span><br><span class="line">        tag: oldFiber.tag,</span><br><span class="line">        stateNode: oldFiber.stateNode,</span><br><span class="line">        props: element.props,</span><br><span class="line">        parent: wipFiber,</span><br><span class="line">        alternate: oldFiber,</span><br><span class="line">        partialState: oldFiber.partialState,</span><br><span class="line">        effectTag: UPDATE</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (element &amp;&amp; !sameType) &#123;</span><br><span class="line">      newFiber = &#123;</span><br><span class="line">        type: element.type,</span><br><span class="line">        tag:</span><br><span class="line">          typeof element.type === &quot;string&quot; ? HOST_COMPONENT : CLASS_COMPONENT,</span><br><span class="line">        props: element.props,</span><br><span class="line">        parent: wipFiber,</span><br><span class="line">        effectTag: PLACEMENT</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (oldFiber &amp;&amp; !sameType) &#123;</span><br><span class="line">      oldFiber.effectTag = DELETION;</span><br><span class="line">      wipFiber.effects = wipFiber.effects || [];</span><br><span class="line">      wipFiber.effects.push(oldFiber);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (oldFiber) &#123;</span><br><span class="line">      oldFiber = oldFiber.sibling;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (index == 0) &#123;</span><br><span class="line">      wipFiber.child = newFiber;</span><br><span class="line">    &#125; else if (prevFiber &amp;&amp; element) &#123;</span><br><span class="line">      prevFiber.sibling = newFiber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    index++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æœ€åä¸€æ­¥ï¼Œæ›´æ–°åˆ°dom</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">function commitAllWork(fiber) &#123;</span><br><span class="line">  fiber.effects.forEach(f =&gt; &#123;</span><br><span class="line">    commitWork(f);</span><br><span class="line">  &#125;);</span><br><span class="line">  fiber.stateNode._rootContainerFiber = fiber;</span><br><span class="line">  nextUnitOfWork = null;</span><br><span class="line">  pendingCommit = null;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function commitWork(fiber) &#123;</span><br><span class="line">  if (fiber.tag == HOST_ROOT) &#123;</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  let domParentFiber = fiber.parent;</span><br><span class="line">  while (domParentFiber.tag == CLASS_COMPONENT) &#123;</span><br><span class="line">    domParentFiber = domParentFiber.parent;</span><br><span class="line">  &#125;</span><br><span class="line">  const domParent = domParentFiber.stateNode;</span><br><span class="line"></span><br><span class="line">  if (fiber.effectTag == PLACEMENT &amp;&amp; fiber.tag == HOST_COMPONENT) &#123;</span><br><span class="line">    domParent.appendChild(fiber.stateNode);</span><br><span class="line">  &#125; else if (fiber.effectTag == UPDATE) &#123;</span><br><span class="line">    updateDomProperties(fiber.stateNode, fiber.alternate.props, fiber.props);</span><br><span class="line">  &#125; else if (fiber.effectTag == DELETION) &#123;</span><br><span class="line">    commitDeletion(fiber, domParent);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function commitDeletion(fiber, domParent) &#123;</span><br><span class="line">  let node = fiber;</span><br><span class="line">  while (true) &#123;</span><br><span class="line">    if (node.tag == CLASS_COMPONENT) &#123;</span><br><span class="line">      node = node.child;</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line">    domParent.removeChild(node.stateNode);</span><br><span class="line">    while (node != fiber &amp;&amp; !node.sibling) &#123;</span><br><span class="line">      node = node.parent;</span><br><span class="line">    &#125;</span><br><span class="line">    if (node == fiber) &#123;</span><br><span class="line">      return;</span><br><span class="line">    &#125;</span><br><span class="line">    node = node.sibling;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰‹å†™ä¸€ä¸ªç²¾ç®€ç‰ˆReact</title>
      <link href="/2018/12/30/React-stack/"/>
      <url>/2018/12/30/React-stack/</url>
      
        <content type="html"><![CDATA[<h1 id="å…ˆè´´åŸæ–‡ï¼Œrespectï¼ä»¥ä¸‹æ˜¯æ€»ç»“æ€è€ƒ"><a href="#å…ˆè´´åŸæ–‡ï¼Œrespectï¼ä»¥ä¸‹æ˜¯æ€»ç»“æ€è€ƒ" class="headerlink" title="å…ˆè´´åŸæ–‡ï¼Œrespectï¼ä»¥ä¸‹æ˜¯æ€»ç»“æ€è€ƒ"></a>å…ˆè´´åŸæ–‡ï¼Œrespectï¼ä»¥ä¸‹æ˜¯æ€»ç»“æ€è€ƒ</h1><p><a href="https://juejin.im/post/5c0c7304f265da613e22106c?utm_source=gold_browser_extension" target="_blank" rel="noopener">200è¡Œä»£ç å®ç°ç®€ç‰ˆreact</a></p><hr><h1 id="React-Component-jsx-vdom"><a href="#React-Component-jsx-vdom" class="headerlink" title="React = Component + jsx + vdom"></a>React = Component + jsx + vdom</h1><ul><li><p>Component = (class component) + (functional component)</p><h2 id="elementï¼ˆtypeof-type-â€™stringâ€™-â€™domèŠ‚ç‚¹â€™-â€™ç»„ä»¶å®ä¾‹â€™ï¼‰"><a href="#elementï¼ˆtypeof-type-â€™stringâ€™-â€™domèŠ‚ç‚¹â€™-â€™ç»„ä»¶å®ä¾‹â€™ï¼‰" class="headerlink" title="elementï¼ˆtypeof type=â€™stringâ€™?â€™domèŠ‚ç‚¹â€™:â€™ç»„ä»¶å®ä¾‹â€™ï¼‰"></a>element<object>ï¼ˆtypeof type=â€™stringâ€™?â€™domèŠ‚ç‚¹â€™:â€™ç»„ä»¶å®ä¾‹â€™ï¼‰</object></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function Button(props) &#123;&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  type: &apos;button&apos;||Button</span><br><span class="line">  props: &#123;</span><br><span class="line">    className: &apos;button button-blue&apos;,</span><br><span class="line">    children: &#123;</span><br><span class="line">      type: &apos;button-children&apos;,</span><br><span class="line">      props: &#123;</span><br><span class="line">        children: &apos;nb!&apos;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æé—®ï¼šReactå¦‚ä½•å°†jsxè¯­æ³•è½¬æ¢ä¸ºçº¯å¯¹è±¡ï¼Ÿ<br>ç­”æ¡ˆï¼šç»„ä»¶ç±»è¿”å›å€¼ç»è¿‡Babelï¼ˆDiyReact.createElementï¼‰<br>è¾“å‡º<code>var foo = createElement(&#39;div&#39;,{id:&#39;foo&#39;},&#39;nb!&#39;);</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// è½¬æ¢ä¸ºelementå¯¹è±¡</span><br><span class="line">function createElement(type, props, ...children) &#123;</span><br><span class="line">  props = Object.assign(&#123;&#125;,props);</span><br><span class="line">  props.children = [].concat(...children)</span><br><span class="line">    .filter(child =&gt; child != null &amp;&amp; child !== false)</span><br><span class="line">    .map(child =&gt; child instanceof Object ? child : createTextElement(child))</span><br><span class="line">  return &#123;type, props&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><h2 id="element-amp-amp-dom"><a href="#element-amp-amp-dom" class="headerlink" title="element &amp;&amp; dom"></a>element &amp;&amp; dom</h2><p><img src="https://user-gold-cdn.xitu.io/2018/12/9/16790a131646f2ad?imageView2/0/w/1280/h/960/ignore-error/1" alt="dom"></p></li><li><p>ViewModel = vdomTree + diffAlgori</p><h2 id="vdomTree"><a href="#vdomTree" class="headerlink" title="vdomTree"></a>vdomTree</h2><p>creatElement()å‡½æ•°æœ€ç»ˆè¾“å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å¯¹å…¶ä¸­çš„propsæˆ–è€…stateè¿›è¡Œç›‘å¬ä¸æ›´æ–°ï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰<br>æ•´ä¸ªé¡µé¢å¯¹åº”ä¸€é¢—å¯ä»¥å®æ—¶æ›´æ–°çŠ¶æ€çš„è™šæ‹ŸdomèŠ‚ç‚¹æ ‘ğŸŒ²</p><h2 id="diffAlgoriï¼ˆé¿å…åˆ é™¤é‡å»ºdomèŠ‚ç‚¹çš„å¼€é”€ï¼‰"><a href="#diffAlgoriï¼ˆé¿å…åˆ é™¤é‡å»ºdomèŠ‚ç‚¹çš„å¼€é”€ï¼‰" class="headerlink" title="diffAlgoriï¼ˆé¿å…åˆ é™¤é‡å»ºdomèŠ‚ç‚¹çš„å¼€é”€ï¼‰"></a>diffAlgoriï¼ˆé¿å…åˆ é™¤é‡å»ºdomèŠ‚ç‚¹çš„å¼€é”€ï¼‰</h2><p><img src="https://user-gold-cdn.xitu.io/2018/12/9/16790a13163a4fa7?imageView2/0/w/1280/h/960/ignore-error/1" alt="diffç®—æ³•"></p></li><li><p>ReactDOM.render()<br>reactå…¥å£å³æ˜¯ç¬¬ä¸€å¸§ï¼Œæ‰€ä»¥æ­¤åçš„å¸§åªä¼šåœ¨æŒ‚è½½æœŸdiff<br>å¦‚ï¼šcompentDidMountã€componentWillUnmount</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// rootInstanceç”¨æ¥ç¼“å­˜ä¸€å¸§vdom</span><br><span class="line">let rootInstance = nullï¼Œè¿™é‡Œå³æ˜¯ç¬¬ä¸€å¸§</span><br><span class="line">function render(element, parentDom) &#123;</span><br><span class="line">  // prevInstanceæŒ‡å‘å‰ä¸€å¸§</span><br><span class="line">  const prevInstance = rootInstance // è¿™é‡Œå®ç°çš„ä»…æ˜¯ReactDOM.render,éç»„ä»¶render</span><br><span class="line">  // elementå‚æ•°æŒ‡å‘æ–°ç”Ÿæˆçš„vdomTree</span><br><span class="line">  const nextInstance = reconcile(parentDom, prevInstance, element) // å¯¹æ¯”å‰åå¸§</span><br><span class="line">  // è°ƒç”¨å®Œreconcileç®—æ³•ï¼ˆå³diffç®—æ³•ï¼‰åå°†rootInstanceæŒ‡å‘æœ€æ–°ä¸€å¸§</span><br><span class="line">  rootInstance = nextInstance</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æé—®ï¼šä½ è¿™é‡Œç”¨instanceè¡¨ç¤ºå¸§ï¼Œé‚£è·Ÿå‰é¢çš„elementæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ<br>ç­”æ¡ˆï¼šinstance = element + dom<br>åœ¨å¯¹æ¯”å‰åå¸§è°ƒç”¨reconcile()è¿›è¡Œdiffæ¯”è¾ƒæ—¶éœ€è¦æ›´æ–°åº”ç”¨åˆ°çœŸå®dom<br>ç”±æ­¤è¿˜éœ€è¦å®ç°ä¸€ä¸ªinstantiateå‡½æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">function instantiate(element) &#123;</span><br><span class="line">  const &#123;type, props=&#123;&#125;&#125; = element</span><br><span class="line">  const isDomElement = typeof type === &apos;string&apos;</span><br><span class="line">  // åŒºåˆ†å‡½æ•°å¼ç»„ä»¶ä¸ç±»ç»„ä»¶</span><br><span class="line">  const isClassElement = !!(type.prototype &amp;&amp; type.prototype.isReactComponent)</span><br><span class="line">  if(isDomElement) &#123;</span><br><span class="line">    // åˆ›å»ºdom</span><br><span class="line">    const isTextElement = type === TEXT_ELEMENT</span><br><span class="line">    const dom = isTextElement ?</span><br><span class="line">    document.createTextNode(&apos;&apos;) :</span><br><span class="line">    document.createElement(type)</span><br><span class="line">    // è®¾ç½®domå±æ€§ï¼Œç»‘å®šdomäº‹ä»¶</span><br><span class="line">    updateDomProperties(dom, [], element.props)</span><br><span class="line">    const children = props.children || []</span><br><span class="line">    const childInstances = children.map(instantiate) // å­èŠ‚ç‚¹é€’å½’</span><br><span class="line">    const childDoms = childInstances.map(childInstance =&gt; childInstance.dom)</span><br><span class="line">    childDoms.forEach(childDom =&gt; dom.appendChild(childDom))</span><br><span class="line">    const instance = &#123;element, dom, childInstances&#125;</span><br><span class="line">    return instance</span><br><span class="line">  &#125; else if(isClassElement) &#123;</span><br><span class="line">    const instance = &#123;&#125;</span><br><span class="line">    const publicInstance = createPublicInstance(element, instance)</span><br><span class="line">    const childElement = publicInstance.render()</span><br><span class="line">    const childInstance = instantiate(childElement) // å­èŠ‚ç‚¹é€’å½’</span><br><span class="line">    Object.assign(instance, &#123;dom: childInstance.dom, element, childInstance, publicInstance&#125;)</span><br><span class="line">    reuturn instance</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    const childElement = type(element.props)</span><br><span class="line">    const childInstance = instantiate(childElement) // å­èŠ‚ç‚¹é€’å½’</span><br><span class="line">    const instance = &#123;</span><br><span class="line">      dom: childInstance.dom,</span><br><span class="line">      element,</span><br><span class="line">      childInstance</span><br><span class="line">    &#125;</span><br><span class="line">    return instance</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>æé—®ï¼šä½ è¯´è¿™ä¹ˆå¤šæˆ‘ä¹Ÿä¸æƒ³çœ‹å•Šï¼Œæœ€æ ¸å¿ƒçš„å¯¹æ¯”å‰åå¸§æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ<br>ç­”æ¡ˆï¼šreconcile()<br><code>ç”±stackç®—æ³•ï¼ˆé€’å½’å®ç°ï¼Œé˜»å¡çº¿ç¨‹ï¼‰å‡çº§ä¸ºReact16ä¸­fiberæ¶æ„ï¼ˆrequestIdleCallbackï¼‰</code><br><img src="https://user-gold-cdn.xitu.io/2018/12/9/16790a13163656b3?imageView2/0/w/1280/h/960/ignore-error/1" alt="reconcile"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">  function reconcile(parentDom, instance, element) &#123;</span><br><span class="line">  if (instance === null) &#123;</span><br><span class="line">    const newInstance = instantiate(element);</span><br><span class="line">    // componentWillMount</span><br><span class="line">    newInstance.publicInstance</span><br><span class="line">      &amp;&amp; newInstance.publicInstance.componentWillMount</span><br><span class="line">      &amp;&amp; newInstance.publicInstance.componentWillMount();</span><br><span class="line">    parentDom.appendChild(newInstance.dom);</span><br><span class="line">    // componentDidMount</span><br><span class="line">    newInstance.publicInstance</span><br><span class="line">      &amp;&amp; newInstance.publicInstance.componentDidMount</span><br><span class="line">      &amp;&amp; newInstance.publicInstance.componentDidMount();</span><br><span class="line">    return newInstance;</span><br><span class="line">  &#125; else if (element === null) &#123;</span><br><span class="line">    // componentWillUnmount</span><br><span class="line">    instance.publicInstance</span><br><span class="line">      &amp;&amp; instance.publicInstance.componentWillUnmount</span><br><span class="line">      &amp;&amp; instance.publicInstance.componentWillUnmount();</span><br><span class="line">    parentDom.removeChild(instance.dom);</span><br><span class="line">    return null;</span><br><span class="line">  &#125; else if (instance.element.type !== element.type) &#123;</span><br><span class="line">    const newInstance = instantiate(element);</span><br><span class="line">    // componentDidMount</span><br><span class="line">    newInstance.publicInstance</span><br><span class="line">      &amp;&amp; newInstance.publicInstance.componentDidMount</span><br><span class="line">      &amp;&amp; newInstance.publicInstance.componentDidMount();</span><br><span class="line">    parentDom.replaceChild(newInstance.dom, instance.dom);</span><br><span class="line">    return newInstance;</span><br><span class="line">  &#125; else if (typeof element.type === &apos;string&apos;) &#123;</span><br><span class="line">    updateDomProperties(instance.dom, instance.element.props, element.props);</span><br><span class="line">    instance.childInstances = reconcileChildren(instance, element);</span><br><span class="line">    instance.element = element;</span><br><span class="line">    return instance;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    if (instance.publicInstance</span><br><span class="line">      &amp;&amp; instance.publicInstance.shouldcomponentUpdate) &#123;</span><br><span class="line">      if (!instance.publicInstance.shouldcomponentUpdate()) &#123;</span><br><span class="line">        return;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // componentWillUpdate</span><br><span class="line">    instance.publicInstance</span><br><span class="line">      &amp;&amp; instance.publicInstance.componentWillUpdate</span><br><span class="line">      &amp;&amp; instance.publicInstance.componentWillUpdate();</span><br><span class="line">    instance.publicInstance.props = element.props;</span><br><span class="line">    const newChildElement = instance.publicInstance.render();</span><br><span class="line">    const oldChildInstance = instance.childInstance;</span><br><span class="line">    const newChildInstance = reconcile(parentDom, oldChildInstance, newChildElement);</span><br><span class="line">    // componentDidUpdate</span><br><span class="line">    instance.publicInstance</span><br><span class="line">      &amp;&amp; instance.publicInstance.componentDidUpdate</span><br><span class="line">      &amp;&amp; instance.publicInstance.componentDidUpdate();</span><br><span class="line">    instance.dom = newChildInstance.dom;</span><br><span class="line">    instance.childInstance = newChildInstance;</span><br><span class="line">    instance.element = element;</span><br><span class="line">    return instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function reconcileChildren(instance, element) &#123;</span><br><span class="line">  const &#123; dom, childInstances &#125; = instance;</span><br><span class="line">  const newChildElements = element.props.children || [];</span><br><span class="line">  const count = Math.max(childInstances.length, newChildElements.length);</span><br><span class="line">  const newChildInstances = [];</span><br><span class="line">  for (let i = 0; i &lt; count; i++) &#123;</span><br><span class="line">    newChildInstances[i] = reconcile(dom, childInstances[i], newChildElements[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  return newChildInstances.filter(instance =&gt; instance !== null);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote></li></ul>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºå›¢é˜Ÿ</title>
      <link href="/2018/12/29/team/"/>
      <url>/2018/12/29/team/</url>
      
        <content type="html"><![CDATA[<h1 id="å›¢é˜Ÿ"><a href="#å›¢é˜Ÿ" class="headerlink" title="å›¢é˜Ÿ"></a>å›¢é˜Ÿ</h1><ul><li><p>ç›®æ ‡é‡åŒ–<br>å¯¹äºæ–°éœ€æ±‚çš„æŠŠæ§ï¼Œéœ€è¦leaderè€ƒè™‘ã€ç»†åŒ–æ¯ä¸€ä¸ªé‡è¦çš„ç‚¹ï¼Œkpiæ˜¯å¤šå°‘ï¼Œåˆç†åˆ†é…åˆ°ç ”å‘å±‚ï¼Œ<br>å…·ä½“å®ç°äº¤ç»™ç ”å‘ï¼Œé¡¹ç›®æ’æœŸå…·é—®å…·åˆ†ï¼Œå¯¹äºå‰ç«¯å›¢é˜Ÿæ¥è®²ï¼Œå¯ä»¥ä»é¡µé¢è½¬æ¢ç‡å…¥æ‰‹ï¼Œå»ºç«‹è®¢å•<br>æ¼æ–—æ¨¡å‹ï¼Œåšæ€§èƒ½åˆ†æä¼˜åŒ–ï¼ŒUIäº¤äº’ä¼˜åŒ–ï¼Œæ¯ä¸€ä¸ªå…·ä½“çš„å±‚é¢éƒ½éœ€è¦è½¬åŒ–ç›®æ ‡</p></li><li><p>è§£å†³é—®é¢˜<br>å›¢é˜Ÿé…åˆä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°kpiæœªå®Œæˆï¼Œæ— ä¼‘æ­¢åŠ ç­ï¼Œé«˜å‹è¿­ä»£ï¼Œå¯¼è‡´ä¸€æ¬¡è¿­ä»£æˆ˜çº¿æ‹‰é•¿ï¼Œå‡ºç°ç–²æƒ«ï¼Œ<br>æ•ˆç‡é™ä½ï¼Œå®¹æ˜“çŠ¯é”™ï¼Œåˆå¦‚ä½•å¸®åŠ©æ–°äººå¿«é€Ÿèå…¥å›¢é˜Ÿï¼Œä¸Šæ‰‹é¡¹ç›®ã€‚</p><p>æ€è€ƒå›¢é˜Ÿåˆ¶å®šçš„ä»äº§å“-&gt;è®¾è®¡-&gt;å¼€å‘-&gt;æµ‹è¯•-&gt;ä¸Šçº¿è¿™ä¸€å¥—æµç¨‹æ˜¯å¦ä¸ºå½“å‰æœ€é€‚åˆæµç¨‹ï¼ŒåŠæ—¶åšå‡º<br>è°ƒæ•´ï¼Œå¯¹äºå…¬å…±æœåŠ¡ä¸å·¥å…·åŒ–ã€è‡ªåŠ¨åŒ–æœåŠ¡ç­‰ï¼Œæœ‰æ²¡æœ‰å†…éƒ¨ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚</p></li></ul><h1 id="ä¸ªäºº"><a href="#ä¸ªäºº" class="headerlink" title="ä¸ªäºº"></a>ä¸ªäºº</h1><ul><li><p>æ„è¯†<br>åšä¸šåŠ¡ä¹‹å‰ï¼Œæ˜¯å¦å¯¹é¡¹ç›®æ•´ä½“æœ‰å…¨å±€æ„è¯†ï¼Œæ˜¯å¦èƒ½åˆ†æ¸…ä¸»æ¬¡ï¼Œå¯¹äºå›¢é˜Ÿå†…çš„æ¯ä¸€ä¸ªæµç¨‹æ˜¯å¦æœ‰äº²è‡ªå‚ä¸ï¼Œ<br>æ²Ÿé€šæ–¹é¢æ˜¯å¦èƒ½è¡¨è¾¾åˆ°ä½ï¼ŒçŸ¥é“è‡ªå·±åœ¨å›¢é˜Ÿä¸­çš„æ‹…å½“ä½ç½®ï¼Œé€è¿‡ç°è±¡çœ‹æœ¬è´¨ï¼Œå½“æœ‰é—®é¢˜åæœ‰æ²¡æœ‰æ·±å…¥äº†è§£<br>è¿‡æ¡†æ¶èƒŒåçš„åŸç†ï¼Œæˆ–è€…æ¶æ„æ–¹é¢å‡ºäº†ä»€ä¹ˆé—®é¢˜</p></li><li><p>æŠ€æœ¯<br>è‰¯è ä¸é½çš„åŒäº‹å¦‚ä½•ç›¸å¤„ä¸æ²Ÿé€šï¼Œå¦‚ä½•æå‡è‡ªå·±çš„å¼€å‘æ•ˆç‡ï¼Œåœ¨é¢å¯¹æŸäº›é—®é¢˜æœ‰æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”èƒ½<br>æœ‰æ¡ç†ã€æ¸…æ™°çš„é˜è¿°ç»™åŒäº‹ï¼Œæ˜¯å¦å¯ä»¥åšä¸€äº›å·¥å…·ç±»æˆ–è€…UIåº“ç­‰çš„ä¸œè¥¿æ¥å¸®åŠ©å›¢é˜Ÿæ”¹å–„é‡å¤åŠ³åŠ¨çš„çŠ¶å†µï¼Œ<br>å¦‚ä½•ç»„ç»‡å†…éƒ¨åˆ†äº«ï¼Œæå‡å›¢é˜Ÿç»¼åˆæŠ€æœ¯èƒ½åŠ›</p></li></ul><h1 id="å…¬å…±ç®¡ç†"><a href="#å…¬å…±ç®¡ç†" class="headerlink" title="å…¬å…±ç®¡ç†"></a>å…¬å…±ç®¡ç†</h1><ul><li>å›¢é˜Ÿå·¥å…·åŒ–ç¨‹åº¦ä¸æˆç†Ÿåº¦æ­£ç›¸å…³</li><li>æœ€ä¼˜ä¸æœ€åˆé€‚è§£å†³æ–¹æ¡ˆ</li><li>åä½œæˆæœ¬ä¸æ‰§è¡ŒåŠ›</li><li>æ˜¯å¦æœ‰feedback(åé¦ˆæœºåˆ¶)</li></ul>]]></content>
      
      
      <categories>
          
          <category> doc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è·¨åŸŸ</title>
      <link href="/2018/12/29/cors/"/>
      <url>/2018/12/29/cors/</url>
      
        <content type="html"><![CDATA[<h2 id="åŒæºç­–ç•¥"><a href="#åŒæºç­–ç•¥" class="headerlink" title="åŒæºç­–ç•¥"></a>åŒæºç­–ç•¥</h2><ul><li>åè®®+åŸŸå+ç«¯å£ éƒ½ç›¸åŒ</li><li>é™åˆ¶Cookieã€localStorageã€IndexDBã€Ajax</li></ul><h2 id="æ–¹æ¡ˆ"><a href="#æ–¹æ¡ˆ" class="headerlink" title="æ–¹æ¡ˆ"></a>æ–¹æ¡ˆ</h2><ul><li>é€šè¿‡jsonpè·¨åŸŸ</li><li>document.domain + iframeè·¨åŸŸ</li><li>location.hash + iframe</li><li>window.name + iframeè·¨åŸŸ</li><li>postMessageè·¨åŸŸ</li><li>è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰</li><li>nginxä»£ç†è·¨åŸŸ</li><li>nodejsä¸­é—´ä»¶ä»£ç†è·¨åŸŸ</li><li>WebSocketåè®®è·¨åŸŸ</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li>CORSä¸ºä¸»æµè§£å†³æ–¹æ¡ˆ</li><li>åå‘ä»£ç†çš„é…ç½®ä¸ä½¿ç”¨nodejsä¸­é—´ä»¶åŸç†ç±»ä¼¼</li><li>å„æ–¹æ¡ˆä¼˜ç¼ºç‚¹</li></ul>]]></content>
      
      
      <categories>
          
          <category> code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åšå®¢è¯´æ˜</title>
      <link href="/2018/12/28/introduce/"/>
      <url>/2018/12/28/introduce/</url>
      
        <content type="html"><![CDATA[<h1 id="å…³äºæˆ‘çš„åšå®¢"><a href="#å…³äºæˆ‘çš„åšå®¢" class="headerlink" title="å…³äºæˆ‘çš„åšå®¢"></a>å…³äºæˆ‘çš„åšå®¢</h1><ul><li>åšäº†æ”¹ç‰ˆ</li><li>æŠ€æœ¯å’Œç”Ÿæ´»éƒ½ä¼šè®°å½•ä¸‹æ¥</li><li>è¾“å‡ºå¹²è´§</li></ul><h1 id="å…³äºä¸»é¢˜"><a href="#å…³äºä¸»é¢˜" class="headerlink" title="å…³äºä¸»é¢˜"></a>å…³äºä¸»é¢˜</h1><ul><li>Freemind(<a href="https://github.com/blackshow/hexo-theme-freemind.386" target="_blank" rel="noopener">https://github.com/blackshow/hexo-theme-freemind.386</a>)</li><li>so cool!</li></ul><h1 id="çºªå¿µ"><a href="#çºªå¿µ" class="headerlink" title="çºªå¿µ"></a>çºªå¿µ</h1><ul><li>ä»Šå¤©ä¹Ÿæ˜¯ç¬¬ä¸€ä»½å·¥ä½œç¦»èŒ</li></ul>]]></content>
      
      
      <categories>
          
          <category> doc </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
